{% extends 'base.html.twig' %}

{% block title %}Hello HomeController!{% endblock %}

{% block body %}
    <div class="container"><h1 style="color: #FFFFFF; padding-top: 2rem; padding-bottom: 5rem">Sortie</h1>
        <div class="row">
            <div class="card text-center w-100 align-middle">
                <div class="card-body">
                    <h1> Créer une Sortie </h1>
                    <div class="d-flex justify-content-center">
                        <div class="p-6">
                            {{ form_start(sortieForm) }}
                            <a>Nom de la Sortie : {{ form_widget(sortieForm.nom) }}</a> <br>
                            <a>Date et Heure de la sortie : {{ form_widget(sortieForm.dateHeureDebut) }}</a>
                            <a>Date limite d'inscription : {{ form_widget(sortieForm.dateLimiteInscritpion) }}</a>
                            <a>Nombre de places : {{ form_widget(sortieForm.nbInscritpionsMax) }}</a> <br>
sy
                            <a>Durée : {{ form_widget(sortieForm.duree) }}</a> <br>
                            <a>Description et infos : {{ form_widget(sortieForm.infosSortie) }}</a> <br>

                        </div>
                        <div class="p-6">
                            <div class="d-flex flex-column mb-3">

                                <a>  {{ userSortie.campus }}</a>
                                <input type="hidden" id="campus" value="{{ userSortie.campus.id }}" name="campus">
                                <div onclick="myFunction()">Lieu : {{ form_widget(sortieForm.lieu) }}</div> <br>
                                <button><a class="nav-link text-primary" href="{{ path('app_lieu_new') }}">Creer
                                        Lieu</a></button>


                                <a> Rue : <input id="nomRue" value=" "></a>
                                <a> Code postal : <input id="codePostale" value=" "></a>
                                <a> Latitude :<input id="latitude" value=" "></a>
                                <a> Longitude :<input id="longitude" value=" "></a>


                            </div>
                        </div>
                    </div>
                    <div class="d-flex justify-content-center">
                        <div class="p-12">
                            <button type="submit" name="button" value="enregistre" class="btn btn-outline-danger">
                                Enregistrer
                            </button>
                            <button type="submit" name="button" value="publier" class="btn btn-outline-warning">Publier
                                la sortie
                            </button>
                            <button type="submit" name="button" value="annuler" class="btn btn-outline-info">Annuler
                            </button>
                        </div>
                    </div>



                    <script>
                        /**
                         * fonction qui recupére id de la div ""menulieu" avec le onclick qui appel la fonction
                         *
                         * le fetch va concaténer l'api et l'id pour recupere le json
                         * recupération et rechercher rue, latitude , longitude  dans position =>
                         * */
                        function myFunction(id) {
                            fetch('http://127.0.0.1:8000/modifierSortie/apiLieu/'+id)
                                .then(retour=>retour.json())
                                .then(position=> {
                                    let rueLieu = position.rue;
                                    let codePostale = position.codePostal;
                                    let longitudeLieu = position.longitude;
                                    let latitudeLieu = position.latitude;
                                    /**
                                     * console.log permet d'afficher dans la console
                                     * **/
                                    console.log(longitudeLieu);
                                    console.log(latitudeLieu);
                                    document.getElementById("latitude").value = latitudeLieu;
                                    document.getElementById("longitude").value = longitudeLieu;
                                    document.getElementById("nomRue").value = rueLieu;
                                    document.getElementById("codePostal").value = codePostale;
                                });

                        }
                    </script>
                    {{ form_end(sortieForm) }}
                </div>
            </div>
        </div>
    </div>





{% endblock %}
